import{r as m,f as E,u as R,b as $,j as e,B as N}from"./index-Bw8vxug1.js";import{M as O,m as z,a as C}from"./Buttons-CLO9Hq2r.js";var A=new Map,y=new WeakMap,P=0,k=void 0;function B(t){return t?(y.has(t)||(P+=1,y.set(t,P.toString())),y.get(t)):"0"}function L(t){return Object.keys(t).sort().filter(s=>t[s]!==void 0).map(s=>`${s}_${s==="root"?B(t.root):t[s]}`).toString()}function M(t){const s=L(t);let r=A.get(s);if(!r){const a=new Map;let i;const o=new IntersectionObserver(n=>{n.forEach(l=>{var d;const c=l.isIntersecting&&i.some(u=>l.intersectionRatio>=u);t.trackVisibility&&typeof l.isVisible>"u"&&(l.isVisible=c),(d=a.get(l.target))==null||d.forEach(u=>{u(c,l)})})},t);i=o.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),r={id:s,observer:o,elements:a},A.set(s,r)}return r}function V(t,s,r={},a=k){if(typeof window.IntersectionObserver>"u"&&a!==void 0){const d=t.getBoundingClientRect();return s(a,{isIntersecting:a,target:t,intersectionRatio:typeof r.threshold=="number"?r.threshold:0,time:0,boundingClientRect:d,intersectionRect:d,rootBounds:d}),()=>{}}const{id:i,observer:o,elements:n}=M(r),l=n.get(t)||[];return n.has(t)||n.set(t,l),l.push(s),o.observe(t),function(){l.splice(l.indexOf(s),1),l.length===0&&(n.delete(t),o.unobserve(t)),n.size===0&&(o.disconnect(),A.delete(i))}}function T({threshold:t,delay:s,trackVisibility:r,rootMargin:a,root:i,triggerOnce:o,skip:n,initialInView:l,fallbackInView:d,onChange:c}={}){var u;const[f,I]=m.useState(null),p=m.useRef(),[b,j]=m.useState({inView:!!l,entry:void 0});p.current=c,m.useEffect(()=>{if(n||!f)return;let g;return g=V(f,(w,S)=>{j({inView:w,entry:S}),p.current&&p.current(w,S),S.isIntersecting&&o&&g&&(g(),g=void 0)},{root:i,rootMargin:a,threshold:t,trackVisibility:r,delay:s},d),()=>{g&&g()}},[Array.isArray(t)?t.toString():t,f,i,a,o,n,r,d,s]);const v=(u=b.entry)==null?void 0:u.target,h=m.useRef();!f&&v&&!o&&!n&&h.current!==v&&(h.current=v,j({inView:!!l,entry:void 0}));const x=[I,b.inView,b.entry];return x.ref=x[0],x.inView=x[1],x.entry=x[2],x}const _=({id:t,img:s,title:r,precio:a,etiqueta:i})=>{const[o,n]=m.useState(!0),{InsertarCarrito:l}=E(),{isAuthenticade:d,setNumeroProductos:c,numeroProductos:u}=R(),f=$(),{ref:I,inView:p}=T({triggerOnce:!0,threshold:.1}),b=async()=>{try{n(!0),localStorage.setItem("platillo",r),f(`/platillo/${r}`)}catch{N.error("No se pudo obtener el platillo")}finally{n(!1)}},j=()=>i==="oferta"?"bg-red-600":i==="nuevo"?"bg-[#35bcb5]":"",v=async()=>{if(d)try{const h=parseFloat(a),x=localStorage.getItem("id");if(!navigator.onLine){const w=JSON.parse(localStorage.getItem("carritoOffline"))||[];w.push({id:t,idUser:x,cantidad:1,precio:h}),localStorage.setItem("carritoOffline",JSON.stringify(w)),localStorage.setItem("syncStatus","0"),c(u+1),N.info("Se agregara cuando se conecte a Internet");return}await l(t,x,1,h)&&(N.success("Platillo agregado al carrito"),setTimeout(()=>{f("/shoppingcar")},1e3))}catch{N.error("Error al agregar al carrito")}else f("/login")};return e.jsxs("div",{className:"max-w-sm rounded-xl overflow-hidden bg-zinc-800 relative",children:[e.jsx("button",{className:"w-full",onClick:b,children:e.jsxs("div",{ref:I,className:"w-full h-36 flex items-center justify-center bg-[#282828] rounded-t-xl",children:[p&&e.jsx("img",{className:`w-full h-36 object-cover rounded-t-xl transition-opacity duration-500 ${o?"opacity-0":"opacity-100"}`,src:`https://labarbada.store/img/${s}`,alt:"imagen",onLoad:()=>n(!1)}),o&&e.jsx("div",{className:"w-full h-36 bg-[#282828] flex items-center justify-center rounded-t-xl",children:e.jsx("span",{className:"text-gray-400",children:"Cargando..."})})]})}),(i==="oferta"||i==="nuevo")&&e.jsx("div",{className:`absolute top-0 right-0 px-2 py-1 text-white text-sm font-bold rounded-l ${j()}`,children:i}),e.jsxs("div",{className:"w-full flex",children:[e.jsxs("div",{className:"px-6 py-4 flex flex-col text-lg w-3/5",children:[e.jsx("h2",{children:r}),e.jsxs("p",{className:"text-orange-500 font-bold text-2xl",children:["$",a]})]}),e.jsx("div",{className:"w-2/5 p-1 m-1 flex items-center justify-end",children:e.jsx(O,{fun:v})})]})]})},F=()=>e.jsxs(z.div,{className:"max-w-sm rounded-xl overflow-hidden bg-zinc-800 relative animate-pulse",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[e.jsx("div",{className:"w-full h-36 bg-[#282828] rounded-t-xl flex items-center justify-center",children:e.jsx("div",{className:"w-24 h-24 bg-gray-600 rounded-full"})}),e.jsxs("div",{className:"w-full flex",children:[e.jsxs("div",{className:"px-6 py-4 flex flex-col text-lg w-3/5",children:[e.jsx("div",{className:"bg-gray-600 h-4 w-3/4 mb-2"}),e.jsx("div",{className:"bg-gray-600 h-4 w-1/2"})]}),e.jsx("div",{className:"w-2/5 p-1 m-1 flex items-center justify-end",children:e.jsx("div",{className:"bg-gray-600 h-10 w-10 rounded-full"})})]})]}),J=({title:t,img:s,p:r,precio:a,delet:i,plus:o,less:n,count:l})=>e.jsxs("div",{className:"w-[90%] sm:w-[80%] md:w-3/4 h-auto md:h-28 bg-[#282828] rounded-3xl flex flex-col md:flex-row items-center justify-around p-4 mb-4 mx-auto",children:[e.jsx("img",{src:`https://labarbada.store/img/${s}`,alt:t,className:"w-full h-32 md:w-[10%] md:h-auto rounded-2xl object-cover mb-2 md:mb-0"}),e.jsx("h2",{className:"w-full md:w-[15%] text-center md:text-left",children:t}),e.jsx("div",{className:"hidden md:flex w-full md:w-[25%] h-16 md:h-3/4 overflow-auto justify-center items-center",style:{scrollbarWidth:"none"},children:e.jsx("p",{className:"text-xs text-center md:text-left",children:r})}),e.jsxs("div",{className:"w-full md:w-[14%] flex justify-center items-center space-x-2 h-16 md:h-2/5",children:[e.jsx(C,{icon:"material-symbols:check-indeterminate-small-rounded",color:"bg-zinc-800",hovColor:"hover:bg-zinc-400",border:"border",width:"w-1/4 sm:w-1/3 md:w-2/5",height:"h-8 sm:h-full",click:n}),e.jsx("p",{children:l}),e.jsx(C,{icon:"ic:baseline-plus",color:"bg-zinc-800",hovColor:"hover:bg-zinc-400",border:"border",width:"w-1/4 sm:w-1/3 md:w-2/5",height:"h-8 sm:h-full",click:o})]}),e.jsxs("p",{className:"w-full md:w-[7%] text-center md:text-left",children:["$",a]}),e.jsx("div",{className:"w-full md:w-[16%] flex justify-center items-center",children:e.jsx(C,{text:"Eliminar",icon:"mdi:trash-outline",color:"bg-red-500",hovColor:"hover:bg-red-600",textHover:"",width:"w-full md:w-4/5",click:i})})]}),H=({items:t})=>{const s=t.reduce((r,a)=>r+parseFloat(a.subtotal),0);return e.jsxs("div",{className:"bg-[#151515] text-slate-100 rounded-lg p-6 shadow-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Resumen de Pago"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"hidden md:grid grid-cols-3 border-b border-gray-700 pb-2",children:[e.jsx("span",{children:"Producto"}),e.jsx("span",{className:"text-center",children:"Cantidad"}),e.jsx("span",{className:"text-right",children:"Precio"})]}),t.map((r,a)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 border-b border-gray-700 py-2",children:[e.jsx("span",{children:r.nombre_platillo}),e.jsx("span",{className:"md:text-center",children:r.cantidad}),e.jsxs("span",{className:"md:text-right",children:["$",r.subtotal]})]},a))]}),e.jsxs("div",{className:"flex justify-between text-xl font-bold",children:[e.jsx("span",{children:"Total a Pagar:"}),e.jsxs("span",{children:["$",s.toFixed(2)]})]})]})},U=()=>{const[t,s]=m.useState(!1),[r,a]=m.useState(null),[i,o]=m.useState(!1),[n,l]=m.useState(!1);m.useEffect(()=>{const c=window.navigator.userAgent.toLowerCase(),u=/iphone|ipad|ipod/.test(c),f=/safari/.test(c)&&!/chrome/.test(c);u&&f&&!window.navigator.standalone&&(l(!0),s(!0))},[]),m.useEffect(()=>{const c=u=>{u.preventDefault(),a(u),s(!0)};return window.addEventListener("beforeinstallprompt",c),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const d=async()=>{if(r){o(!0),r.prompt();const{outcome:c}=await r.userChoice;o(!1),console.log(c==="accepted"?"El usuario acept贸 instalar la PWA":"El usuario rechaz贸 instalar la PWA"),a(null),s(!1),localStorage.setItem("pwaAccepted","true")}};return m.useEffect(()=>{localStorage.getItem("pwaAccepted")&&s(!1)},[]),t?e.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 p-4 rounded-lg shadow-lg border max-w-sm md:max-w-lg z-50 bg-opacity-50 bg-black backdrop-filter backdrop-blur-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-2xl",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-bold",children:n?"Agregar a pantalla de inicio":"Descarga la app"}),e.jsx("p",{className:"text-sm text-gray-300",children:n?"Para agregar esta aplicaci贸n a tu pantalla de inicio en iOS, abre el men煤 de compartir en Safari y selecciona 'Agregar a pantalla de inicio'.":"Te damos la opci贸n de descargarla en tu dispositivo m贸vil."})]}),n?e.jsx("button",{onClick:()=>s(!1),className:"bg-black text-white px-4 py-2 rounded hover:bg-gray-500",children:"Cerrar"}):e.jsx("button",{onClick:d,className:`bg-black text-white px-4 py-2 rounded hover:bg-gray-500 ${i?"opacity-50 cursor-not-allowed":""}`,disabled:i,children:i?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"loader-spinner"})," ",e.jsx("span",{children:"Instalando..."})]}):"Descargar"})]})}):null};export{F as C,U as P,H as R,_ as a,J as b};
